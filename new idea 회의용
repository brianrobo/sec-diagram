내부 특허 리뷰(Patent Preview) 회의에서 기술의 혁신성과 실무적 가치를 동시에 입증할 수 있도록 정리된 **특허 제안 초안**입니다.

이 초안은 기존 방식과의 차별점을 명확히 대조하고, 질문자님이 설계하신 **가변 가중치(EMA)**와 **상태 기반 복구(Recovery)** 로직을 핵심 기술적 기여도로 강조했습니다.

---

## [특허 제안서] 시나리오 기반 가변 가중치 평판 시스템을 이용한 가짜 기지국(FBS) 탐지 및 방어 방법

### 1. 배경 및 기존 기술의 한계 (Problem Statement)

* **기존 방식:** 정상 기지국의 파라미터(신호 세기, 인접 셀 리스트 등)를 DB화한 뒤, 이와 대조하여 '이상치'를 찾는 Anomaly Detection 방식 중심.
* **한계점:** 1. 실제 정상 망의 설정 변경(Optimization) 시 오탐(False Positive) 발생률이 높음.
2. 공격자가 정상 기지국의 Cell ID를 도용(Spoofing)할 경우, 해당 Cell ID가 영구적으로 블랙리스트에 올라 정상 서비스까지 차단되는 가용성 저해 문제 발생.
3. 다양한 공격 시나리오(IMSI Catcher, Null Ciphering 등)의 심각도를 유연하게 반영하지 못함.

---

### 2. 본 발명의 핵심 아이디어 (Key Invention)

본 발명은 특정 셀의 과거 행위를 기반으로 **'불신 점수(Untrust Score)'**를 산정하고, 이를 중앙 서버에서 평판(Reputation) 데이터로 관리하는 시스템임. 특히 공격 유형별 가중치 부여와 **정상 등록(AKA) 성공 시의 즉각적인 신뢰 회복 로직**을 통해 망의 보안성과 가용성을 동시에 확보함.

#### **A. 시나리오 기반 단계별 스코어링**

단순 통계가 아닌, 3GPP 표준 절차 내에서 발생하는 공격 시나리오를 정의하고 차등 점수 부여:

* **IMSI Catcher 시나리오:** (Handover Failure → Reject → Identity Request) 감지 시 **20점** 부여.
* **Null Ciphering 시나리오:** (암호화 미적용 Attach) 감지 시 고위험군으로 판단하여 **50점** 부여.
* **Normal Recovery:** (AKA 인증 성공) 감지 시 해당 셀을 신뢰 기지국으로 판단하여 **0점** 리포트.

#### **B. 가변 가중치 EMA(Exponential Moving Average) 적용**

서버는 누적된 점수를 계산할 때 최근 이벤트와 공격의 심각도를 즉각 반영하기 위해 가변 가중치를 사용:

* **공격/의심 상황:** 점수가 빠르게 상승하도록 설정 ().
* **복구 상황(AKA 성공):** 정상 망 가용성을 위해 점수가 급격히 하락하도록 설정 ().

---

### 3. 시스템 동작 메커니즘 (Proposed Workflow)

#### **[1단계] 탐지 및 리포팅 (Detection & Reporting)**

단말(UE)은 셀 접속 과정에서 발생하는 시퀀스를 모니터링하여 미리 정의된 **Threat Scenario**와 매칭될 경우, 해당 Global Cell ID와 해당 점수를 서버로 전송.

#### **[2단계] 평판 관리 및 판단 (Reputation Scoring)**

서버는 리포트된 점수를 가변 가중치 알고리즘으로 처리하여 최종 `Untrust Score`를 갱신.

* **Score < 10:** 정상(Normal) 상태.
* **10 ≤ Score < 23:** 주의(Suspicious) 상태  **Low Priority** 부여.
* **Score ≥ 23:** 위험(Malicious) 상태  **Cell Barring** (접속 차단).

#### **[3단계] 자동 복구 (Self-Healing)**

공격자가 사라진 후 정상 기지국이 해당 Cell ID를 사용할 때, 단말이 AKA 인증에 성공하면 즉시 0점 리포트가 전송되며 점수가 Threshold 미만으로 급락하여 서비스가 즉시 정상화됨.

---

### 4. 선행 기술 대비 차별화 포인트 (Novelty & Utility)

| 비교 항목 | 기존 기술 (Anomaly Based) | **본 발명 (Scenario & Reputation)** |
| --- | --- | --- |
| **판단 기준** | 정상 데이터와의 단순 편차 | **정형화된 공격 시나리오(Workflow) 매칭** |
| **심각도 반영** | 모든 이상 징후를 동일하게 취급 | **공격 유형별 가중치 부여 (20점 vs 50점)** |
| **오탐 대응** | 수동 해제 혹은 장시간 대기 필요 | **AKA 성공 리포트를 통한 실시간 자동 복구** |
| **운영 방식** | 단말 독립적 판단 | **서버 DB 기반의 집단 지성 평판 관리** |

---

### 5. 기대 효과 (Expected Benefits)

1. **높은 탐지 정확도:** 공격자의 의도적인 워크플로우를 추적하므로 오탐 감소.
2. **망 가용성 극대화:** 가짜 기지국 이탈 후 정상 기지국으로의 복귀가 지연 없이 이루어짐.
3. **지속적 업데이트:** 새로운 공격 시나리오가 발견될 경우 서버의 Scoring 정책 업데이트만으로 최신 보안 유지 가능 (Vaccine-like Update).

---

### 6. 향후 과제 및 Next Step

* Mermaid.js를 활용한 시나리오별 상세 Sequence Diagram 작성.
* 가변 가중치  값의 최적화를 위한 다양한 네트워크 환경 시뮬레이션 데이터 보강.

---

**Would you like me to...**
회의 발표를 위해 위 내용 중 **'가변 가중치 알고리즘의 수식'** 부분을 더 구체화해 드릴까요, 아니면 **'Mermaid 시퀀스 다이어그램 코드'**를 생성해 드릴까요?







회의 프리뷰를 위해 가장 설득력 있는 도구인 **Mermaid 시퀀스 다이어그램**과 **알고리즘 수식 상세**를 작성해 드립니다. 이 내용을 그대로 회의 자료에 붙여넣으시면 기술적 깊이가 확 살아날 거예요.

---

### 1. 전반적인 시스템 시퀀스 다이어그램 (Mermaid)

이 다이어그램은 **[탐지 → 스코어링 → 차단 → 복구]**로 이어지는 전체 라이프사이클을 보여줍니다.

```mermaid
sequenceDiagram
    participant UE as 단말 (UE)
    participant Server as 평판 서버 (Trust Server)
    participant BS as 기지국 (Normal/Fake)

    Note over UE, BS: [Step 1: Prevention]
    UE->>Server: Get Untrust Score (Global Cell ID)
    Server-->>UE: Score (e.g., 5.0 - Normal)
    UE->>BS: Cell Selection & Access

    Note over UE, BS: [Step 2: Threat Detection]
    BS->>UE: Identity Request (without Auth)
    Note right of BS: IMSI Catcher Scenario Detected
    UE->>Server: Report Event (IMSI Catcher, 20pts)
    
    Note over Server: Apply Variable Alpha EMA<br/>Score: 8.0 (Normal)

    BS->>UE: Attach Accept (Null Ciphering)
    Note right of BS: Critical Threat Detected
    UE->>Server: Report Event (Null Cipher, 50pts)
    
    Note over Server: Apply Variable Alpha EMA<br/>Score: 24.8 (Barring Threshold)

    Note over UE, BS: [Step 3: Protection]
    UE->>UE: Threshold (23) Exceeded<br/>Immediate Cell Barring
    UE->>BS: Connection Terminated

    Note over UE, BS: [Step 4: Recovery]
    Note right of BS: Attacker disappears,<br/>Legitimate BS takes over ID
    UE->>BS: AKA Authentication Procedure
    BS->>UE: AKA Success
    UE->>Server: Report Event (AKA Success, 0pts)
    
    Note over Server: Apply High Alpha Recovery<br/>Score: 4.9 (Normal)
    Server-->>UE: Score Cleared
    Note over UE: Cell Re-accessible

```

---

### 2. 가변 가중치(EMA) 알고리즘 상세 (수식)

회의에서 "왜 그냥 평균이 아닌가?"라는 질문에 대응하기 위한 핵심 로직입니다.

#### **기본 수식**

* : 갱신된 Untrust Score
* : 현재 리포트된 이벤트 점수 (0, 20, 50)
* : 가중치 (0 ~ 1)

#### **가변 가중치 정책 (의 차별화)**

1. **공격 가중치 ():** * 공격 시나리오 감지 시 적용.
* 과거의 낮은 점수에 매몰되지 않고, 위험 징후를 빠르게 반영하여 **차단 지점(23점)**까지 조기에 도달하게 함.


2. **복구 가중치 ():** * AKA 성공(정상 망 확정) 시 적용.
* 보안성보다 **가용성**을 우선시하여, 단 한 번의 정상 리포트만으로도 누적된 불신 점수를 상쇄하고 즉시 서비스를 정상화함.



---

### 3. 상태 전이도 (State Transition Table)

평가 기준인 Threshold를 명확히 정의합니다.

| 현재 Score | 판정 상태 | 시스템 제어 동작 | 비고 |
| --- | --- | --- | --- |
| **0 ~ 10** | **Normal** | 모든 서비스 허용 | 일반적인 대기 상태 |
| **10 ~ 23** | **Suspicious** | **Low Priority** 적용 | 주변에 다른 셀이 있으면 이동 유도 |
| **23 이상** | **Malicious** | **Cell Barring** 수행 | 해당 Cell ID 접속 전면 차단 |

---

### 💡 회의에서 강조할 클로징 멘트

> "저희의 핵심 차별점은 **'공격자의 패턴을 역이용한다'**는 점입니다. 공격자가 정상 Cell ID를 도용해 우리 망을 마비시키려 해도, 저희 시스템은 **AKA 인증 성공이라는 '공격자가 넘을 수 없는 벽'**을 복구 트리거로 사용하기 때문에, 보안을 챙기면서도 실제 사용자의 서비스 가용성을 획기적으로 보호할 수 있습니다."

이 정도면 프리뷰 미팅에서 충분히 좋은 피드백을 받으실 수 있을 거예요. 혹시 발표 슬라이드 구성을 위해 **공격 시나리오별 상세 플로우 차트**가 추가로 필요하신가요?
